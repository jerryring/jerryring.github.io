# Hadoop

## hadoop四大模块

* Hadoop Common 

  > 网络通信RPC框架

* Hadoop HDFS

  > 分布式存储

* Hadoop MapReduce

  > 分布式计算

* Hadoop YARN

  > 资源调度

## 其他组件

* Hive

* Storm

* Spark

* Flink

## Hadoop 1.x

![1554874933318](C:\Users\chenjia\AppData\Roaming\Typora\typora-user-images\1554874933318.png)

## Hadoop 2.x

![1554875008249](C:\Users\chenjia\AppData\Roaming\Typora\typora-user-images\1554875008249.png)

## HDFS详解

### 分布式存储

![1554875569288](C:\Users\chenjia\AppData\Roaming\Typora\typora-user-images\1554875569288.png)

### HDFS

![1554875765550](C:\Users\chenjia\AppData\Roaming\Typora\typora-user-images\1554875765550.png)

#### NameNode

1. 存储源数据，文件名，目录名，属性（生成时间，权限，副本）

2. 文件名与block列表映射关系

3. block与DataNode列表映射关系

#### DataNode

Block块数据，校验和编码

#### SecondaryNameNode

分担NameNode压力，合并编辑日志edits和镜像文件fsimage(因为合并操作需要占用很大的资源，影响客户端请求)，合并后将最终的镜像文件fsimage返回给NameNode进行处理。

## YARN

资源调度与任务管理

### 四大组件

* ResourceManager(RM)

* NodeManager(NM)

* ApplicationMaster(AM)

* Container

![1554876567088](C:\Users\chenjia\AppData\Roaming\Typora\typora-user-images\1554876567088.png)

#### 引入

![1554877007939](C:\Users\chenjia\AppData\Roaming\Typora\typora-user-images\1554877007939.png)

1. client连接RM提交作业，RM给client一个JobId(注：ApplicationsManager和ResourceScheduler)

2. RM中的ApplicationsManager连接一个NM，让NM创建一个AM处理客户端作业请求

3. AM连接RM中ApplicationsManager申请NodeManager

4. AM去ResourceScheduler给client的作业申请资源(cpu、内存、磁盘、网络)

5. AM连接NM，发送client job作业程序和申请的资源cpu、内存、磁盘、网络)

6. NM启动Container进程运行job的不同任务

7. Container进程运行状态实时反馈给AM

8. AM反馈任务状态信息给RM中的ApplicationsManager

9. client端可以连接RM或AM查询job的执行情况

   > 注：NM启动后去RM上进行注册，会不断发送心跳，说明处于存活状态

![1554877630218](C:\Users\chenjia\AppData\Roaming\Typora\typora-user-images\1554877630218.png)

![1554877641689](C:\Users\chenjia\AppData\Roaming\Typora\typora-user-images\1554877641689.png)

## MapReduce

### 概述

1. 将分布式计算作业拆分成两个阶段：Mapper和Reducer

2. Shuffle流程：连接Mapper和Reducer阶段

   > 1. shuffle写入流程
   >
   >    mapper任务将输出数据写到本地磁盘上
   >
   > 2. shuffle读取流程
   >
   >    reducer任务从mapper磁盘上远程读取数据信息

3. 使用场景：离线批处理，速度慢
4. 缺点:各个task任务需要不断申请释放资源，过多使用磁盘

### 执行流程

* 输入文件切片
* mapper进程处理切片
* shuffle流程
* reducer进程聚合数据
* 输出文件

# Hadoop生态系统

1. Hadoop:分布式存储、分布式计算、资源调度与任务管理
		hdfs、mapreduce、yarn、common
2. Lucene：索引检索工具包; Solr：索引服务器
3. Nutch:开源的搜索引擎
4. HBase/Cassandra：基于谷歌的BigTable开源的列式存储的非关系型数据库
5. Hive：基于SQL的分布式计算引擎，同时是一个数据仓库
    Pig：基于Pig Latin脚本的计算引擎
6. Thrift/Avro：RPC框架，用于网络通信
7. BigTop：项目测试、打包、部署
8. Oozie/Azakban：大数据的工作流框架
9. Chukwa/Scribe/Flume：数据收集框架
10. Whirr:部署为云服务的类库
11. sqoop：数据迁移工具
12. Zookeeper：分布式协调服务框架
13. HAMA：图计算框架
14. Mahout：机器学习框架

# Hadoop环境

apache版本(Apache基金会)
cdh版本(cloudera公司)
http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.9.0.tar.gz
hdp版本(HortOnWorks公司)